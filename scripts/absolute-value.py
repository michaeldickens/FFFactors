"""

absolute-value.py
-----------------

Author: Michael Dickens <mdickens93@gmail.com>
Created: 2017-03-24

""" 

from scipy.stats import pearsonr

rets = [-0.2604053293001477,0.733152029834006,0.6423635328344786,0.4829549878498288,0.3780337942041289,0.27423648199853623,0.329498128790431,6.477013548809707e-2,0.25696221661998725,0.26632036748266347,-8.277456095027447e-3,0.2802996372176731,0.10684665570843119,0.24355488364522554,9.0615918276543e-2,0.30461303130139905,-0.1949463757643442,0.5474257567030432,0.30183778881514345,0.6534080313384536,0.23576656747586053,0.1652564097552301,2.134081577361262e-2,0.25201189141206454,-4.717070259858884e-2,0.13080498295216492,0.6156032993894982,0.5698519623765383,0.25806329449480153,0.8699296112754743,0.19499578498007206,-4.8817496344406665e-2,0.20262456038482712,-4.6416521185484325e-2,-0.41273848450237677,0.6452431938876773,0.2529286403182756,-0.1182161190372446,0.11657844884876507,0.5175304596127568] 

ebitev = [0.15467502202142708,0.2304955661884757,0.1842843657941382,0.16716645947704498,0.19127692336978686,0.21632764178831196,0.1779414041123951,0.13513480458499505,0.16035630325863012,0.10313200784460902,0.10238075999479129,0.12442858661248457,9.289510792618842e-2,8.170986151705567e-2,9.917518958014487e-2,0.10245865299773095,8.9014579615265e-2,9.48607836789953e-2,6.444651051994435e-2,6.691309256425704e-2,6.713709354291626e-2,8.436079356400422e-2,7.722211365225598e-2,7.060478505505978e-2,6.436210547216195e-2,5.90602776361938e-2,4.613044561892249e-2,5.644493195031118e-2,4.790565354854893e-2,7.823849333962868e-2,6.460711521666736e-2,7.645106981492915e-2,7.951510073288501e-2,7.925026338105812e-2,7.038154376013267e-2,0.11325996072896971,7.229334533104108e-2,8.047300735010993e-2,9.336890959015828e-2,7.925281478161252e-2]

pairs = zip(ebitev, rets)

start_year = 1974

print "**** Yearly returns"
print "| Year | EBIT/EV | Return |"
print "|------+---------+--------|"
for (y, (e, r)) in enumerate(pairs):
    print "| %d | %.2f | %.1f |" % (y + start_year, e, r * 100)

pairs.sort(key=lambda x: x[0])
print "**** Yearly returns sorted by EBIT/EV"
print "| EBIT/EV | Return |"
print "|---------+--------|"
for (e, r) in pairs:
    print "| %.2f | %.1f |" % (e, r * 100)

print "**** Average (arithmetic) returns for EBIT/EV quartiles"
print "| Q | EBIT/EV | Return |"
print "|---+---------+--------|"
for i in range(4):
    avg_ebit = sum([pair[0] for pair in pairs[(i*10):(i*10+10)]]) / 10
    avg_ret = sum([pair[1] for pair in pairs[(i*10):(i*10+10)]]) / 10
    print "| %d | %.2f | %.1f |" % (i + 1, avg_ebit, 100 * avg_ret)

print "**** Correlation between EBIT/EV and return"
r, p = pearsonr(ebitev, rets)
print "r:", r
print "p:", p
